<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
	<link rel="stylesheet" href="style.css"/>
	<title>PhoS</title>
</head>

<body>
	<h1>PhoS - Phobia Smart Assistent</h1>

	<section>
		<h3>0. Contributors</h3>
		<ul>
			<li>Berea V. Emanuel-Vasile, Software Systems Engineering, 2nd year</li>
			<li>Serseniuc D. Simona-Ecaterina, Software Systems Engineering, 2nd year</li>
		</ul>
	</section>

	<section>
		<h3>1. Introduction</h3>
		<div>
			<p>The purpose of this application is to help users better plan their activities.
				The user is able to creat an acount and register his - if he has any - phobias. He will be able
				to register persons that he is in contact with and their phobias.
			<p>When planning a future activity, the user will give a description of what the activity consist and he
				will link the persons from his account with the activity and/or add new phobias.
				The application will generate a list of suggestions and drugs based on phobias of the user and of his linked persons. </p>
			<p>The application will be available in browser - desktop, tablet and phone.</p>
		</div>

		<div>
			<p>PhoS (Phobia Smart Assistant)</p>
			<ul>
				<li>is a <b>semantic web application</b></li>
				<li>help the user to create a profile and assign to himself phobias and activities</li>
				<li><b> manage</b> a list of <b>contact persons</b></li>
				<li>search for <b>informations</b> about a <b>phobia</b> and attach it to persons and activities</li>
				<li>attach a list of phobias and activities to each person</li>
				<li>display <b>warnings</b> and suggest <b>remedies</b> for an activity that take place for a set of persons</li>
			</ul>
		</div>
	</section>

	<section>
		<h3>2. Use cases</h3>
		<p>As a user i want to:</p>
		<ul>
			<li>find information about a phobia</li>
			<li>register persons to my account</li>
			<li>atach to a person the phobias that he/she has</li>
			<li>get warnings and remedies about a created event</li>
		</ul>
		<p>Bellow we present some UseCase diagrams</p>
		<img src="usecases/login_register_workflow.png" alt="login_register_workflow" height="350px">
		<p class="middle">Login/Register Workflow</p>
		<img src="usecases/search_phobias_workflow.png" alt="search_phobias_workflow" height="350px">
		<p class="middle"> Search phobia Workflow</p>
		<img src="usecases/person_workflow.png" alt="person_workflow" height="350px">
		<p class="middle">Person Workflow</p>
		<img src="usecases/activity_workflow.png" alt="activity_workflow" height="350px">
		<p class="middle">Activity Workflow</p>
		<img src="usecases/remedies_workflow.png" alt="remedies_workflow" height="350px">
		<p class="middle">Remedies Workflow</p>

	</section>

	<section>
		<h3>3. Architecture</h3>
		<img src="architecture.png" width="600px">

		<p>Wireframes</p>
		<p><a href="PhoS - desktop.pdf" target="_blank">Desktop</a></p>
		<p><a href="PhoS-tablet.pdf" target="_blank">Tablet</a></p>
		<p><a href="PhoS-phone.pdf" target="_blank">Phone</a></p>
	</section>

	<section>
		<h3>4. Tehnologies</h3>
		<h4>4.1. Client</h4>
			<ul>
				<li>AngularJS</li>
			</ul>
		<h4>4.2. Server</h4>
			<ul>
				<li>will expose a REST API developed using Symfony PHP framework</li>
				<li>PHP libraries that is used at this moment to interact (extract/serialize/convert) with the RDF data:
					<ul>
						<li>EasyRDF
							<ul>
								<li>
									<a href="http://www.easyrdf.org/" target="_blank"> http://www.easyrdf.org/</a>
								</li>
								<li>
									<a href="https://github.com/njh/easyrdf" target="_blank">https://github.com/njh/easyrdf</a>
								</li>
							</ul>
						</li>
					</ul>
				</li>
				<li>Other PHP libraries that we could use for future development (kept as a reference):
					<ul>
						<li>ARC2 - <a href="https://github.com/semsol/arc2" target="_blank">https://github.com/semsol/arc2</a></li>
						<li>sparqllib
							<ul>
								<li><a href="http://graphite.ecs.soton.ac.uk/sparqllib/" target="_blank">http://graphite.ecs.soton.ac.uk/sparqllib/</a></li>
								<li><a href="https://github.com/cgutteridge/PHP-SPARQL-Lib" target="_blank">https://github.com/cgutteridge/PHP-SPARQL-Lib</a></li>
							</ul>
						</li>
					</ul>
				</li>
			</ul>
			The main modules of the server will be:
			<ul>
				<li>Service - the classes that will access the Stardog database and Dbpedia</li>
				<li>Manager - the classes that will process the data that we get, after we run the SPARQL queries on the RDF stores</li>
				<li>Controller - controllers that will call the functions from the manager classes and expose the REST API</li>
			</ul>

			Symfony bundle (library) used for developing the REST API:
			<ul>
				<li><a href="https://github.com/FriendsOfSymfony/FOSRestBundle">https://github.com/FriendsOfSymfony/FOSRestBundle</a></li>
			</ul>
			Other REST API related libraries, that we can use for future development (kept as a reference):
			<ul>
				<li><a href="https://github.com/willdurand/BazingaRestExtraBundle">https://github.com/willdurand/BazingaRestExtraBundle</a></li>
				<li><a href="https://github.com/willdurand/BazingaHateoasBundle">https://github.com/willdurand/BazingaHateoasBundle</a></li>
				<li><a href="https://github.com/willdurand/Negotiation">https://github.com/willdurand/Negotiation</a></li>
				<li><a href="https://github.com/nelmio/NelmioApiDocBundle">https://github.com/nelmio/NelmioApiDocBundle</a></li>
				<li><a href="https://github.com/doctrine/DoctrineCacheBundle">https://github.com/doctrine/DoctrineCacheBundle (can register custom cache providers like: APC, mongoDB, redis, etc.)</a></li>
			</ul>
		</section>

		<section>
			<h3>5. Data sources</h3>
			<p>Will use as data sources:</p>
			<ul>
				<li>Dbpedia: <a href="http://dbpedia.org/page/Category:Phobias" target="_blank">http://dbpedia.org/page/Category:Phobias</a></li>
				<li>our own RDF store:
					<ul>
						<li>Stardog database</li>
						<li>will store data about phobias that it is imported from Dbpedia</li>
						<li>will store data about the users, the contact persons and the activities (event/context) that the persons can take part</li>
						<li>will use FOAF (Friend of a Friend) vocabulary to model the user relations: an application user can have many persons that he knows</li>
						<li>will use to store and model the various remedies, symptoms that can apply to a person that have a phobia</li>
					</ul>
				</li>
			</ul>
			<h4>Concepts - schema.org</h4>
			Bellow are the concepts that end up using in our application

			<ul>
				<li>Person - <a href="https://schema.org/Person" target="_blank">https://schema.org/Person </a>
					<ul>
						<li>name</li>
						<li>email</li>
						<li>nickName</li>						
						<li>knows</li>
					</ul>
				</li>
				
				<li>MedicalCondition -<a href="https://schema.org/MedicalCondition" target="_blank"> https://schema.org/MedicalCondition </a>
					<ul>
						<li>cause</li>
						<li>differentialDiagnostic</li>
						<li>possibleCondition</li>
						<li>alternateName</li>
						<li>description</li>
						<li>name</li>
						<li>sameAs</li>
						<li>url</li>
					</ul>
				</li>
			</ul>
		</section>

		<section>
			<h3>6. Ontology</h3>
				For this project we developed our custom ontology, and we modeled the relations between the persons,
				phobias, activities, remedies and symptoms.
				<p>We have the following classes:</p>
				<ul>
					<li>Person</li>
					<li>Phobia</li>
					<li>Activity</li>
					<li>Remedy</li>
					<li>Symptom</li>
				</ul>
				<p>We have created the following DatatypeProperty:</p>
				<ul>
					<li>description</li>
					<li>symptomName</li>
					<li>appearsFor</li>
					<li>forActivity</li>
					<li>hasPhobia</li>
				</ul>
				<img src="printscreens/DatatypeProperty.png" alt="DatatypeProperty" height="110px">
				<p>And we added the following ObjectProperty:</p>
				<ul>
					<li>forPhobia</li>
				</ul>
				<img src="printscreens/ObjectProperty.png" alt="ObjectProperty" height="90px">
			
				<p>We did research on various phobias and review which are the possible remedies. We made a list with the data and populated our ontology.
				Our remedies were based on a phobia and a type of activity associated with it.
				</p>
				
				<img src="printscreens/remedy.png" alt="Remedy" height="200px">
				
				<p>We also have a list of possible symtopms that a person can have when having a phobia</p>
				<img src="printscreens/symptom.png" alt="Symptom" height="130px">
			</ul>
		</section>

		<section>
			<h3>7. Web API</h3>
			<p>See the <a href="api/phos.yaml" target="_blank">yaml</a> or the <a href="api/phos.json" target="_blank">json</a> version of the web API</p>
			<p>
				On the server side we created a Symfony command which access via the EasyRdf library the SPARQL endpoint fro Dbpedia, and downloads all the phobias into our Stardog database.
				We also created our custom ontology, which we also imported into Stardog. Then using Symfony framework and its FOSRestBundle we developed the REST API.
				We decoupled and created 2 Service classes: DbpediaService and StardogService for the accessing the 2 RDF stores.
				Then we created the Manager classes: PhobiaManager, RemedyManager and UserManager which are using the service classes and are querying via SPARQL the RDF stores that we are using.
				Next, on top of that we are using controllers, which are receiving the HTTP request, call the manager classes, and the transform into JSON format the output and sent it as a HTTP response.
				More details about the API can be viewed in the attached specification.
			</p>
		</section>

		<section>
			<h3>8. SparQL quries to access the RDF store</h3>
			
			The main query that we made was to get the pbobias information from Dbpedia.
			<pre>
				PREFIX dbo: <http://dbpedia.org/ontology/>
				PREFIX foaf: <http://xmlns.com/foaf/0.1/>

				SELECT * WHERE  {
					?phobia rdfs:label ?label .
					?phobia dbo:abstract ?info .
					?phobia foaf:isPrimaryTopicOf ?link .
				}
			</pre>
			After that we inserted them in our Stardog database using this query:
			<pre>
				PREFIX dbo: <http://dbpedia.org/ontology/>
				PREFIX foaf: <http://xmlns.com/foaf/0.1/>

				INSERT DATA	{ 
					   <http://phobia.vrinceanu.com/remedies#' . $label) .'>
					   rdfs:label "' . $label .'";
					   dbo:abstract "' . $info . '";
					   foaf:isPrimaryTopicOf "' . $link . '" .
				   }
			</pre>
			
			For our `User` and `Person` we used properties from foaf and some of our own datatypeProperties, as you can see below:
			<pre>
				PREFIX foaf:  <http://xmlns.com/foaf/0.1/>
				SELECT *
				WHERE {
					?person foaf:mbox ?email .
					?person foaf:name ?name .
					?person foaf:sha1 ?password .
					FILTER (?email = "' . $email . '")
				}
			</pre>
			To update an user we had to remove all his information first and after that to add it again. That's how SparQL 1.1 works for an update.
			<pre>
				PREFIX remedies: <http://phobia.vrinceanu.com/remedies#>
				DELETE WHERE {
				   <http://phobia.vrinceanu.com/user#' . $email .'>
				   foaf:mbox "' . $email .'";
				   foaf:name "' . $oldUser['name'] . '" .
				}
							
				DELETE WHERE {
					 <http://phobia.vrinceanu.com/user#' . $email .'> remedies:hasPhobia "' . $phobia . '" .
				}
				INSERT DATA {
					<http://phobia.vrinceanu.com/user#' . $email .'>
				    foaf:mbox "' . $email .'";
				    foaf:name "' . $requestData['name'] . '" .
				}
			</pre>
			
			To get the remedies for an activity we use the query bellow:
			<pre>
				PREFIX remedies: <http://phobia.vrinceanu.com/remedies#>

				SELECT ?description WHERE {                
					?r remedies:forPhobia <' . phobia . '> .
					?r remedies:forActivity "' activity . '" .
					?r remedies:description ?description .
				}
			</pre>
			
		</section>
		<section>
			<h3>8. Bibliography</h3>
			<ul>
				<li><a href="http://wiki.dbpedia.org/" target="_blank">http://wiki.dbpedia.org/</a></li>
				<li><a href="https://www.wikidata.org/wiki/Wikidata:Main_Page" target="_blank">https://www.wikidata.org/wiki/Wikidata:Main_Page</a></li>
				<li><a href="http://schema.org/" target="_blank">http://schema.org/</a></li>
				<li><a href="http://martinfowler.com/articles/richardsonMaturityModel.html" target="_blank">http://martinfowler.com/articles/richardsonMaturityModel.html</a></li>
				<li><a href="https://code.google.com/p/implementing-rest/wiki/RMM" target="_blank">https://code.google.com/p/implementing-rest/wiki/RMM</a></li>
				<li><a href="http://williamdurand.fr/2012/08/02/rest-apis-with-symfony2-the-right-way/" target="_blank">http://williamdurand.fr/2012/08/02/rest-apis-with-symfony2-the-right-way/</a></li>
				<li><a href="https://docs.angularjs.org/guide" target="_blank">https://docs.angularjs.org/guide</a></li>
				<li><a href="http://symfony.com/doc/current/index.html" target="_blank">http://symfony.com/doc/current/index.html</a></li>
				<li><a href="https://github.com/njh/easyrdf" target="_blank">https://github.com/njh/easyrdf</a></li>
				<li><a href="http://www.easyrdf.org/" target="_blank">http://www.easyrdf.org/</a></li>
				<li><a href="http://docs.stardog.com/" target="_blank">http://docs.stardog.com/</a></li>
			</ul>
		</section>
</body>
</html>
